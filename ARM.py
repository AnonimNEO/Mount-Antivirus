#–î–∞–Ω–Ω–æ–µ –°–≤–æ–±–æ–¥–Ω–æ–µ –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ GPL-3.0-only –∏–ª–∏ GPL-3.0-or-later
#–í—ã –∏–º–µ–µ—Ç–µ –ø—Ä–∞–≤–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å, –≤–∑–∏–º–∞—Ç—å –ø–ª–∞—Ç—É –∑–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∞–∫—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–ø–∏–∏, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏–π–Ω—É—é –∑–∞—â–∏—Ç—É –≤ –æ–±–º–µ–Ω –Ω–∞ –ø–ª–∞—Ç—É
#–î–õ–Ø –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –î–ê–ù–ù–û–ì–û –°–í–û–ë–û–î–ù–û–ì–û –ü–†–û–ì–†–ê–ú–ú–ù–û–ì–û –û–ë–ï–°–ü–ï–ß–ï–ù–ò–Ø, –í–ê–ú –ù–ï –¢–†–ï–ë–£–ï–¢–°–Ø –ü–†–ò–ù–Ø–¢–ò–ï –õ–ò–¶–ï–ù–ó–ò–ò Gnu GPL v3.0 –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
#–í –°–õ–£–ß–ê–ï –†–ê–°–ü–†–û–°–¢–†–ê–ù–ï–ù–ò–Ø –û–†–ò–ì–ò–ù–ê–õ–¨–ù–û–ô –ü–†–û–ì–†–ê–ú–ú–´ –ò/–ò–õ–ò –ú–û–î–ï–†–ù–ò–ó–ò–†–û–í–ê–ù–ù–û–ô –í–ï–†–°–ò–ò –ò/–ò–õ–ò –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –ò–°–•–û–î–ù–ò–ö–û–í –í –°–í–û–ï–ô –ü–†–û–ì–†–ê–ú–ú–ï, –í–´ –û–ë–Ø–ó–ê–ù–´ –ó–ê–î–û–ö–£–ú–ï–ù–¢–ò–†–û–í–ê–¢–¨ –í–°–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í –ö–û–î–ï –ò –ü–†–ï–î–û–°–¢–ê–í–ò–¢–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú –í–û–ó–ú–û–ñ–ù–û–°–¢–¨ –ü–û–õ–£–ß–ò–¢–¨ –ò–°–•–û–î–ù–ò–ö–ò –í–ê–®–ï–ô –ö–û–ü–ò–ò –ü–†–û–ì–†–ê–ú–ú–´, –ê –¢–ê–ö–ñ–ï –£–ö–ê–ó–ê–¢–¨ –ê–í–¢–û–†–°–¢–í–û –î–ê–ù–ù–û–ì–û –ü–†–û–ì–†–ê–ú–ú–ù–û–ì–û –û–ë–ï–°–ü–ï–ß–ï–ù–ò–Ø
#–ü–†–ò –†–ê–°–ü–†–û–°–¢–†–ê–ù–ï–ù–ò–ò –ü–†–û–ì–†–ê–ú–ú–´ –í–´ –û–ë–Ø–ó–ê–ù–´ –ü–†–ï–î–û–°–¢–ê–í–ò–¢–¨ –í–°–ï –¢–ï–ñ–ï –ü–†–ê–í–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ –ß–¢–û –ò –ú–´ –í–ê–ú, –ê –¢–ê–ö–ñ–ï –õ–ò–¶–ï–ù–ó–ò–Ø GPL v3
#–ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é –ª–∏—Ü–µ–Ω–∑–∏–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –§–æ–Ω–¥–∞ –°–≤–æ–±–æ–¥–Ω–æ–≥–æ –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –û–±–µ—Å–ø–µ—á–µ–Ω–∏—è - https://www.gnu.org/licenses/gpl-3.0.html
#–ò–ª–∏ –≤ —Ñ–∞–π–ª–µ COPYING.txt –≤ –∞—Ä—Ö–∏–≤–µ —Å —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–æ–º
#Copyleft üÑØ NEO Organization, Departament K 2024 - 2026
#Coded by @AnonimNEO (Telegram)

#–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
from tkinter import ttk, messagebox, simpledialog
import tkinter as tk
#–î–∞—Ç–∞ –∏ –í—Ä–µ–º—è
from datetime import datetime
#–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –û—à–∏–±–æ–∫
from loguru import logger
#–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã
from pathlib import Path
#–†–∞–±–æ—Ç–∞ —Å —Ä–µ–µ—Å—Ç—Ä–æ–º
#import winreg as reg
import winreg
#–†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –∏ –û–°
import xml.etree.ElementTree as ET
import win32com.client
import os

from config import *
from RS import random_string
from OF import get_current_disc, get_offline_reg_path, loaded_hive_names

global ARM_data, autorun_master_version, REG_TYPE_MAP, REG_TYPE_MAP_REV, CREATABLE_REG_TYPES, ARM_CORE_GLOBALS, GUI_ELEMENTS, ultimate_load_cpu, ultimate_load_gpu, ultimate_load_ram, ultimate_load_lam
autorun_master_version = "3.2.3 Beta"

REG_TYPE_MAP = {
    winreg.REG_SZ: "REG_SZ",
    winreg.REG_EXPAND_SZ: "REG_EXPAND_SZ",
    winreg.REG_MULTI_SZ: "REG_MULTI_SZ",
    winreg.REG_DWORD: "REG_DWORD",
    winreg.REG_QWORD: "REG_QWORD",
    winreg.REG_BINARY: "REG_BINARY",
    winreg.REG_NONE: "REG_NONE"
}

#–û–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
REG_TYPE_MAP_REV = {v: k for k, v in REG_TYPE_MAP.items()}

#–°–ø–∏—Å–æ–∫ –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ "–°–æ–∑–¥–∞—Ç—å"
CREATABLE_REG_TYPES = [
    "REG_SZ", "REG_EXPAND_SZ", "REG_MULTI_SZ",
    "REG_DWORD", "REG_QWORD", "REG_BINARY"
]

GUI_ELEMENTS = {
    "master": None,
    "notebook": None,
    "tree": None,
    "tabs": {},
    "vsb": None,
    "current_tab": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è",
    "treeview_data": [],
    "focus_after_update": None
}

#–ö–ª–∞—Å—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –ó–∞–¥–∞—á –≤ –æ–±—ã—á–Ω–æ–π —Å—Ä–µ–¥–µ
class TaskSchedulerManager:
    def __init__(self):
        #–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è COM-–æ–±—ä–µ–∫—Ç–∞ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –ó–∞–¥–∞—á
        try:
            self.scheduler = win32com.client.Dispatch("Schedule.Service")
            self.scheduler.Connect()
            self.root_folder = self.scheduler.GetFolder("\\")
        except Exception as e:
            self.scheduler = None
            self.root_folder = None
            logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:\n{e}")
            messagebox.showerror(random_string(), f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫—É –ó–∞–¥–∞—á.\n{e}")

    #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ –∑–∞–¥–∞—á
    def get_folder(self, task_path):
        folder_path = os.path.dirname(task_path)
        if not folder_path:
            return self.root_folder

        try:
            return self.root_folder.GetFolder(folder_path)
        except Exception:
            return None

    #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ –∑–∞–¥–∞—á–∏
    #def get_name(self, task_path):
    #    return os.path.basename(task_path)

    #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö –∑–∞–¥–∞—á –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
    def traverse_folder(self, folder, all_tasks):
        if not folder:
            return

        #–ü–æ–ª—É—á–∞–µ–º –∑–∞–¥–∞—á–∏ –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ
        tasks = folder.GetTasks(0)
        for task in tasks:
            all_tasks.append(task)

        #–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ö–æ–¥–∏–º –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∏
        subfolders = folder.GetFolders(0)
        for subfolder in subfolders:
            self.traverse_folder(subfolder, all_tasks)

    #–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    def get_all_tasks(self):
        if not self.root_folder:
            return []

        all_com_tasks = []
        self.traverse_folder(self.root_folder, all_com_tasks)
        return all_com_tasks

    #–í–∫–ª—é—á–∞–µ—Ç –∏–ª–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ COM
    def set_task_state_com(self, task_path_full, enable):
        if not self.scheduler:
            return False
        try:
            folder_path = os.path.dirname(task_path_full) or "\\"
            task_name = os.path.basename(task_path_full)
            folder = self.scheduler.GetFolder(folder_path)
            task = folder.GetTask(task_name)

            task.Enabled = enable
            folder.RegisterTaskDefinition(
                task_name, 
                task.Definition, 
                6, 
                None, 
                None, 
                task.Definition.Principal.LogonType
            )
            return True
        except Exception as e:
            logger.error(f"ARM - –û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è COM-–∑–∞–¥–∞—á–∏ {task_path_full}:\n{e}")
            return False

    #–£–¥–∞–ª—è–µ—Ç –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ COM
    def delete_task_com(self, task_path_full):
        if not self.scheduler:
            return False
        try:
            folder_path = os.path.dirname(task_path_full) or "\\"
            task_name = os.path.basename(task_path_full)
            folder = self.scheduler.GetFolder(folder_path)
            folder.DeleteTask(task_name, 0)
            return True
        except Exception as e:
            logger.error(f"ARM - –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è COM-–∑–∞–¥–∞—á–∏ {task_path_full}:\n{e}")
            return False



def ARM(run_in_recovery, first_run):
    #–ü—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if run_in_recovery:
        current_disc, found_disc = get_current_disc(run_in_recovery)
        if not os.path.isfile(f"{current_disc}\\Users\\{default_user_name}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\"):
            user_name = simpledialog.askstring(title=random_string(), prompt=f"–ù–µ –Ω–∞–π–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {default_user_name}\n–í–≤–µ–¥–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ")
        else:
            user_name = default_user_name
        #–ü—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ñ—Ñ–ª–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
        user_startup_path_str = f"{current_disc}\\Users\\{user_name}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\"
        user_startup = Path(user_startup_path_str)
    else:
        appdata_path = os.getenv("APPDATA")

        if appdata_path is not None:
            user_startup = Path(appdata_path) / "Microsoft" / "Windows" / "Start Menu" / "Programs" / "Startup"
        else:
            user_startup = f"C:\\Users\\{default_user_name}\\AppData\\Microsoft\\Windows\\Start Menu\\Program\\Startup\\"
            logger.error("ARM - –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ä–µ–¥—ã APPDATA –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø—É—Ç—å –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∞ Path('.').")



    ARM_CORE_GLOBALS = {
        "user_startup_path": user_startup,
        "REG_KEYS": {
            "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è": None, #–î–ª—è —Ñ–∞–π–ª–æ–≤
            "–†–µ–µ—Å—Ç—Ä": [
                (winreg.HKEY_CURRENT_USER, r"Software\Microsoft\Windows\CurrentVersion\Run", "Run"),
                (winreg.HKEY_CURRENT_USER, r"Software\Microsoft\Windows\CurrentVersion\RunOnce", "RunOnce")
            ],
            "–°–∏—Å—Ç–µ–º–Ω–∞—è": [
                (winreg.HKEY_LOCAL_MACHINE, r"Software\Microsoft\Windows NT\CurrentVersion\Winlogon", "Shell"),
                (winreg.HKEY_LOCAL_MACHINE, r"Software\Microsoft\Windows NT\CurrentVersion\Winlogon", "Userinit")
            ],
            "AppInit_DLLs": [
                (winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows", "AppInit_DLLs",
                 "x64"),
                (winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows", "LoadAppInit_DLLs",
                 "x64"),
                (winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows",
                 "AppInit_DLLs", "x32"),
                (winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows",
                 "LoadAppInit_DLLs", "x32"),
            ],
            "CmdLine": [
                (winreg.HKEY_LOCAL_MACHINE, r"SYSTEM\Setup", "CmdLine"),
                (winreg.HKEY_LOCAL_MACHINE, r"SYSTEM\Setup", "SetupType"),
                (winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System", "EnableCursorSuppression"),
            ]
        },
        #–î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç—É –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç HKEY_ –≤ —Å—Ç—Ä–æ–∫–∏
        "HKEY_MAP": {
            winreg.HKEY_CLASSES_ROOT: "HKEY_CLASSES_ROOT",
            winreg.HKEY_CURRENT_USER: "HKEY_CURRENT_USER",
            winreg.HKEY_LOCAL_MACHINE: "HKEY_LOCAL_MACHINE",
            winreg.HKEY_USERS: "HKEY_USERS",
            winreg.HKEY_CURRENT_CONFIG: "HKEY_CURRENT_CONFIG",
        },
        "OFFLINE_HKEY_MAP": {
            winreg.HKEY_LOCAL_MACHINE: (winreg.HKEY_LOCAL_MACHINE, loaded_hive_names["SOFTWARE"], r"Software"),
            #–î–ª—è –∫–ª—é—á–µ–π, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö—Å—è —Å HKLM\Software
            #–ö–ª—é—á–∏, –Ω–µ –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å HKLM\Software, –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
            winreg.HKEY_CURRENT_USER: (winreg.HKEY_LOCAL_MACHINE, loaded_hive_names["USER"], None)
        }
    }

    try:
        #–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º Unix-—Ç–∞–π–º—à—Ç–∞–º–ø –≤ —á–∏—Ç–∞–µ–º—É—é —Å—Ç—Ä–æ–∫—É
        def format_time(timestamp):
            if timestamp == 0:
                return "–û—à–∏–±–∫–∞"
            return datetime.fromtimestamp(timestamp).strftime("%d-%m-%Y %H:%M:%S")



        #–ü–æ–ª—É—á–∞–µ–º –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        def get_user_startup(ARM_CORE_GLOBALS):
            user_startup_path = ARM_CORE_GLOBALS["user_startup_path"]
            ARM_data = []
            try:
                for item in user_startup_path.iterdir():
                    if item.is_file() and item.name.lower() != "desktop.ini":
                        try:
                            stats = item.stat()
                            ARM_data.append({
                                "–ò–º—è –§–∞–π–ª–∞": item.name,
                                "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è": format_time(stats.st_ctime),
                                "–î–∞—Ç–∞ –ò–∑–º–µ–Ω–µ–Ω–∏—è": format_time(stats.st_mtime),
                                "–î–∞—Ç–∞ –û—Ç–∫—Ä—ã—Ç–∏—è": format_time(stats.st_atime),
                                "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": str(item)
                            })
                        except Exception as e:
                            logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞ {item.name}:\n{e}")
                            ARM_data.append({
                                "–ò–º—è –§–∞–π–ª–∞": item.name,
                                "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è": "–û—à–∏–±–∫–∞",
                                "–î–∞—Ç–∞ –ò–∑–º–µ–Ω–µ–Ω–∏—è": "–û—à–∏–±–∫–∞",
                                "–î–∞—Ç–∞ –û—Ç–∫—Ä—ã—Ç–∏—è": "–û—à–∏–±–∫–∞",
                                "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": str(item)
                            })
            except Exception as e:
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –ø–∞–ø–∫–µ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:\n{e}")
                messagebox.showerror(random_string(), f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞–ø–∫–µ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏.\n{e}")
            return ARM_data



        #–ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞
        def read_registry_key(ARM_CORE_GLOBALS, hkey_const, subkey_path):
            hkey_map = ARM_CORE_GLOBALS["HKEY_MAP"]

            ARM_data = []

            if run_in_recovery:
                #–ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –∫—É—Å—Ç—É –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ
                final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
            else:
                final_hkey = hkey_const
                final_subkey = subkey_path

            #–ò—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å—Ö–æ–¥–Ω—É—é HKEY –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            hkey_name = hkey_map.get(hkey_const, str(hkey_const))
            full_path = f"{hkey_name}\\{subkey_path}"

            try:
                #–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–ª—é—á –¥–ª—è —á—Ç–µ–Ω–∏—è
                with winreg.OpenKey(final_hkey, final_subkey, 0, winreg.KEY_READ) as key:
                    i = 0
                    while True:
                        try:
                            #–ü–µ—Ä–µ—á–∏—Å–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–ª—é—á–µ
                            value_name, value, reg_type = winreg.EnumValue(key, i)
                            ARM_data.append({
                                "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                                "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": str(value),
                                "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": REG_TYPE_MAP.get(reg_type),
                                "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path, #–°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –ø—É—Ç—å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                                "hkey": hkey_const, #–°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—É—é –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
                                "subkey": subkey_path, #–°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –ø—É—Ç—å
                                "value_type": reg_type
                            })
                            i += 1
                        except OSError: #–û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–±—Ä–∞–Ω—ã –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è
                            break
            except FileNotFoundError:
                logger.warning(f"ARM - –ö–ª—é—á —Ä–µ–µ—Å—Ç—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω: {full_path}")
            except Exception as e:
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–∏ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞ {full_path}:\n{e}")
            return ARM_data



        #–ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–ª—é—á–µ–π Run –∏ RunOnce –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        def get_registry_startup(ARM_CORE_GLOBALS):
            reg_keys = ARM_CORE_GLOBALS["REG_KEYS"]
            all_data = []
            #–ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –∫–ª—é—á–∏ –≤ —Å–ø–∏—Å–∫–µ "–†–µ–µ—Å—Ç—Ä"
            for hkey_const, subkey_path, _ in reg_keys["–†–µ–µ—Å—Ç—Ä"]:
                all_data.extend(read_registry_key(ARM_CORE_GLOBALS, hkey_const, subkey_path))
            return all_data



        #–ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è Shell –∏ Userinit –∏–∑ Winlogon
        def get_system_startup(ARM_CORE_GLOBALS):
            reg_keys = ARM_CORE_GLOBALS["REG_KEYS"]
            hkey_map = ARM_CORE_GLOBALS["HKEY_MAP"]
            ARM_data = []
            for hkey_const, subkey_path, value_name in reg_keys["–°–∏—Å—Ç–µ–º–Ω–∞—è"]:
                
                if run_in_recovery:
                    final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
                else:
                    final_hkey = hkey_const
                    final_subkey = subkey_path

                hkey_name = hkey_map.get(hkey_const, str(hkey_const))
                full_path = f"{hkey_name}\\{subkey_path}" 

                try:
                    with winreg.OpenKey(final_hkey, final_subkey, 0, winreg.KEY_READ) as key:
                        value, reg_type = winreg.QueryValueEx(key, value_name)
                        ARM_data.append({
                            "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                            "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": str(value),
                            "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": REG_TYPE_MAP.get(reg_type),
                            "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                            "hkey": hkey_const,
                            "subkey": subkey_path,
                            "value_type": reg_type
                        })
                except Exception as e:
                    logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ {value_name} –∏–∑ {full_path}:\n{e}")
                    ARM_data.append({
                        "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                        "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–û—à–∏–±–∫–∞",
                        "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–û—à–∏–±–∫–∞",
                        "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                        "hkey": hkey_const,
                        "subkey": subkey_path,
                        "value_type": winreg.REG_NONE
                    })
            return ARM_data



        #–ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ AppInit_DLLs –∏ LoadAppInit_DLLs
        def get_dll_startup(ARM_CORE_GLOBALS):
            reg_keys = ARM_CORE_GLOBALS["REG_KEYS"]
            hkey_map = ARM_CORE_GLOBALS["HKEY_MAP"]
            ARM_data = []
            for hkey_const, subkey_path, value_name, bitness in reg_keys["AppInit_DLLs"]:
                if run_in_recovery:
                    final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
                else:
                    final_hkey = hkey_const
                    final_subkey = subkey_path

                #–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ HKEY_const –≤ –∏–º—è:
                hkey_name = hkey_map.get(hkey_const, str(hkey_const))
                full_path = f"{hkey_name}\\{subkey_path}"
                try: #–ò—Å–ø–æ–ª—å–∑—É–µ–º KEY_READ | winreg.KEY_WOW64_64KEY –¥–ª—è 64-–±–∏—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
                    access = winreg.KEY_READ
                    #–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –∫—É—Å—Ç–æ–º, KEY_WOW64_32KEY –Ω–µ –Ω—É–∂–µ–Ω,
                    #—Ç–∞–∫ –∫–∞–∫ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –Ω–∞–ø—Ä—è–º—É—é –∫ 32-–±–∏—Ç–Ω–æ–º—É –ø—É—Ç–∏ (Wow6432Node)
                    #–ù–æ —Å–æ—Ö—Ä–∞–Ω–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
                    if bitness == "x64":
                        pass
                    elif bitness == "x32":
                        access |= winreg.KEY_WOW64_32KEY

                    with winreg.OpenKey(final_hkey, final_subkey, 0, access) as key:
                        value, reg_type = winreg.QueryValueEx(key, value_name)
                        ARM_data.append({
                            "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                            "–ë–∏—Ç–Ω–æ—Å—Ç—å": bitness,
                            "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": str(value),
                            "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": REG_TYPE_MAP.get(reg_type),
                            "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                            "hkey": hkey_const,
                            "subkey": subkey_path,
                            "value_type": reg_type
                        })
                except FileNotFoundError as e:
                    logger.error(f"ARM - –ù–µ –Ω–∞–π–¥–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞ AppInit_DLLs{value_name} ({bitness}) –∏–∑ {full_path}:\n{e}")
                    ARM_data.append({
                        "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                        "–ë–∏—Ç–Ω–æ—Å—Ç—å": bitness,
                        "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–ü–∞—Ä–∞–º–µ—Ç—Ä –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç",
                        "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "REG_NONE",
                        "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                        "hkey": hkey_const,
                        "subkey": subkey_path,
                        "value_type": winreg.REG_NONE
                    })
                except Exception as e:
                    logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ AppInit_DLLs{value_name} ({bitness}) –∏–∑ {full_path}:\n{e}")
                    ARM_data.append({
                        "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                        "–ë–∏—Ç–Ω–æ—Å—Ç—å": bitness,
                        "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–û—à–∏–±–∫–∞",
                        "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–û—à–∏–±–∫–∞",
                        "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                        "hkey": hkey_const,
                        "subkey": subkey_path,
                        "value_type": winreg.REG_NONE
                    })
            return ARM_data


        #–ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ CmdLine
        def get_cmdline_startup(ARM_CORE_GLOBALS):
            reg_keys = ARM_CORE_GLOBALS["REG_KEYS"]
            hkey_map = ARM_CORE_GLOBALS["HKEY_MAP"]
            ARM_data = []
            for hkey_const, subkey_path, value_name in reg_keys["CmdLine"]:
                if run_in_recovery:
                    final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
                else:
                    final_hkey = hkey_const
                    final_subkey = subkey_path

                hkey_name = hkey_map.get(hkey_const, str(hkey_const))
                full_path = f"{hkey_name}\\{subkey_path}"

                try:
                    with winreg.OpenKey(final_hkey, final_subkey, 0, winreg.KEY_READ) as key:
                        value, reg_type = winreg.QueryValueEx(key, value_name)
                        ARM_data.append({
                            "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                            "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": str(value),
                            "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": REG_TYPE_MAP.get(reg_type),
                            "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                            "hkey": hkey_const,
                            "subkey": subkey_path,
                            "value_type": reg_type
                        })
                except Exception as e:
                    logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ {value_name} –∏–∑ {full_path}:\n{e}")
                    ARM_data.append({
                        "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": value_name,
                        "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–û—à–∏–±–∫–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç",
                        "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": "–û—à–∏–±–∫–∞",
                        "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞": full_path,
                        "hkey": hkey_const,
                        "subkey": subkey_path,
                        "value_type": winreg.REG_NONE
                    })
            return ARM_data



        #–°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞
        def create_reg_value(hkey_const, subkey_path, name, reg_type_str, gui_elements):
            reg_type = REG_TYPE_MAP_REV.get(reg_type_str)
            if reg_type is None:
                logger.error(f"ARM - –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Ä–µ–µ—Å—Ç—Ä–∞: {reg_type_str}")
                return False

            if reg_type in (winreg.REG_SZ, winreg.REG_EXPAND_SZ, winreg.REG_MULTI_SZ):
                initial_value = ""
            elif reg_type in (winreg.REG_DWORD, winreg.REG_QWORD):
                initial_value = 0
            elif reg_type == winreg.REG_BINARY:
                initial_value = b""
            else:
                initial_value = ""

            if run_in_recovery:
                final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
            else:
                final_hkey = hkey_const
                final_subkey = subkey_path

            try:
                with winreg.OpenKey(final_hkey, final_subkey, 0, winreg.KEY_SET_VALUE | winreg.KEY_READ) as key:
                    winreg.SetValueEx(key, name, 0, reg_type, initial_value)
                    logger.success(f"ARM - –°–æ–∑–¥–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞: {name} —Å —Ç–∏–ø–æ–º {reg_type_str} –≤ {ARM_CORE_GLOBALS['HKEY_MAP'].get(hkey_const)}\\{subkey_path}")
                    gui_elements["focus_after_update"] = {"type": "name", "value": name}
                    return True
            except PermissionError:
                messagebox.showerror(random_string(), "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–µ—Å—Ç—Ä–∞. –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.")
                return False
            except Exception as e:
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞: {name} –≤ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}:\n{e}")
                messagebox.showerror(random_string(), f'–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞ "{name}".\n{e}')
                return False



        #–û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞
        def update_reg_value(hkey_const, subkey_path, name, new_value, reg_type, item_id, gui_elements):
            if run_in_recovery:
                final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
            else:
                final_hkey = hkey_const
                final_subkey = subkey_path

            try:
                #–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –Ω—É–∂–Ω—ã–π —Ç–∏–ø
                if reg_type in (winreg.REG_DWORD, winreg.REG_QWORD):
                    try:
                        value_to_set = int(new_value)
                    except ValueError:
                        raise ValueError(f"ARM - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ç–∏–ø–∞ {REG_TYPE_MAP.get(reg_type, '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π')}")

                elif reg_type == winreg.REG_MULTI_SZ:
                    value_to_set = new_value.split("\n")

                elif reg_type == winreg.REG_BINARY:
                    try:
                        hex_string = new_value.replace(" ", "")
                        if len(hex_string) % 2 != 0:
                            hex_string = "0" + hex_string

                        value_to_set = bytes.fromhex(hex_string)
                    except ValueError as e:
                        raise ValueError(f"ARM - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è REG_BINARY.\n{e}")

                else:
                    value_to_set = new_value

                with winreg.OpenKey(final_hkey, final_subkey, 0, winreg.KEY_SET_VALUE) as key:
                    winreg.SetValueEx(key, name, 0, reg_type, value_to_set)
                    logger.success(f"ARM - –û–±–Ω–æ–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞: {name} –≤ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}")
                    gui_elements["focus_after_update"] = {"type": "iid", "value": item_id}
                    return True

            except PermissionError:
                messagebox.showerror(random_string(), "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–µ—Å—Ç—Ä–∞. –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.")
                return False
            except ValueError as e:
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞: {name} –≤ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}:\n{e}")
                return False
            except Exception as e:
                messagebox.showerror(random_string(), f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞ '{name}'.\n{e}")
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞: {name} –≤ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}:\n{e}")
                return False



        #–£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞
        def delete_reg_value(hkey_const, subkey_path, name, item_id, gui_elements):
            if run_in_recovery:
                final_hkey, final_subkey = get_offline_reg_path(hkey_const, subkey_path, ARM_CORE_GLOBALS, run_in_recovery)
            else:
                final_hkey = hkey_const
                final_subkey = subkey_path
            try:
                gui_elements["focus_after_update"] = get_next_item_iid(gui_elements, item_id)

                with winreg.OpenKey(final_hkey, final_subkey, 0, winreg.KEY_SET_VALUE) as key:
                    winreg.DeleteValue(key, name)
                    logger.success(f"ARM - –£–¥–∞–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞: {name} –∏–∑ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}")
                    return True
            except PermissionError:
                messagebox.showerror(random_string(), "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞. –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.")
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞: {name} –∏–∑ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}")
                return False
            except Exception as e:
                messagebox.showerror(random_string(), f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞ '{name}'.\n{e}")
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞: {name} –∏–∑ {ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}:\n{e}")
                return False



        #–£–¥–∞–ª—è–µ–º —Ñ–∞–π–ª
        def delete_file(file_path, file_name, item_id, gui_elements):
            file = Path(file_path)
            try:
                if file.exists():
                    gui_elements["focus_after_update"] = get_next_item_iid(gui_elements, item_id)
                    file.unlink()
                    logger.success(f"ARM - –£–¥–∞–ª–µ–Ω —Ñ–∞–π–ª: {file_path}")
                    return True
                return False
            except PermissionError:
                messagebox.showerror(random_string(), "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞.")
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {file_path}")
                return False
            except Exception as e:
                messagebox.showerror(random_string(), f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª '{file.name}'.\n{e}")
                logger.error(f"ARM - –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {file_path}:\n{e}")
                return False



        #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É—Ç–∏ –∫ –ø–∞–ø–∫–µ –∑–∞–¥–∞—á
        def get_tasks_directory():
            #–ï—Å–ª–∏ —Ä–µ–∂–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑—É–µ–º –±—É–∫–≤—É –≤–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–∏—Å–∫–∞
            if run_in_recovery:
                return Path(f"{current_disc}Windows\\System32\\Tasks")
            #–ï—Å–ª–∏ –æ–±—ã—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - –±–µ—Ä–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—É—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
            return Path(os.environ.get("SystemRoot", "C:\\Windows")) / "System32" / "Tasks"



        #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –∏–∑ —Ç–µ–≥–æ–≤ XML
        def strip_namespace(tag):
            if "}" in tag:
                return tag.split('}', 1)[1]
            return tag



        #–°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫–∏ UTF-16
        def save_xml_task(tree, file_path):
            try:
                #Windows Tasks —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É—é—Ç UTF-16 LE –∏ BOM
                with open(file_path, "wb") as f:
                    tree.write(f, encoding="utf-16", xml_declaration=True)
                return True
            except Exception as e:
                logger.error(f"ARM - –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è XML –∑–∞–¥–∞—á–∏ {file_path}:\n{e}")
                return False



        #–ü–æ–ª—É—á–∞–µ–º –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É –∏–∑ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –ó–∞–¥–∞—á (–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ XML –ò–õ–ò COM)
        def get_task_scheduler_startup():
            ARM_data = []

            if not run_in_recovery:
                manager = TaskSchedulerManager()
                com_tasks = manager.get_all_tasks()

                for task in com_tasks:
                    try:
                        #–ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∑–∞–¥–∞—á–∏
                        full_path = task.Path 
                        name = os.path.basename(full_path)
                        is_enabled = task.Enabled

                        #–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (Command)
                        action_path = "–ù–µ—Ç ExecAction"
                        definition = task.Definition

                        for action in definition.Actions:
                            #TASK_ACTION_EXEC = 0 (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ COM)
                            if action.Type == 0: 
                                cmd = action.Path
                                args = action.Arguments
                                action_path = f"{cmd} {args}".strip()
                                break

                        #–ü–æ–ª—É—á–∞–µ–º –∞–≤—Ç–æ—Ä–∞
                        author = definition.RegistrationInfo.Author

                        #–ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è
                        try:
                            date_created = str(task.Definition.RegistrationInfo.Date)
                        except Exception:
                            date_created = "01-01-1970 00:00:00"

                        action_path = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
                        if task.Definition.Actions.Count > 0:
                            action = task.Definition.Actions.Item(1)
                            if action.Type == 0:
                                #–ò–∑–≤–ª–µ–∫–∞–µ–º –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É –∏–∑ —Å–≤–æ–π—Å—Ç–≤–∞ Path —Å–∞–º–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
                                raw_path = getattr(action, "Path", "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")
                                if raw_path != "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ":
                                    action_path = os.path.abspath(raw_path)
            
                        ARM_data.append({
                            "–ò–º—è": name,
                            "–í–∫–ª/–í—ã–∫–ª": "–í–∫–ª—é—á–µ–Ω" if is_enabled else "–û—Ç–∫–ª—é—á–µ–Ω",
                            "–ü—É—Ç—å": action_path,
                            "–ê–≤—Ç–æ—Ä": author,
                            "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è": date_created,
                            "TaskPath": full_path, 
                            "Enabled_raw": is_enabled
                        })
                    except Exception as e:
                        logger.error(f"ARM - –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ COM-–∑–∞–¥–∞—á–∏ {task.Path}:\n{e}")
                        ARM_data.append({
                            "–ò–º—è": task.Path,
                            "–í–∫–ª/–í—ã–∫–ª": "–û—à–∏–±–∫–∞",
                            "–ü—É—Ç—å": "–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è",
                            "–ê–≤—Ç–æ—Ä": "–û—à–∏–±–∫–∞",
                            "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è": None,
                            "TaskPath": task.Path,
                            "Enabled_raw": False
                        })
                return ARM_data

            else:
                tasks_dir = get_tasks_directory()

                if not tasks_dir.exists():
                    logger.error(f"ARM - –ü–∞–ø–∫–∞ –∑–∞–¥–∞—á –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: {tasks_dir}")
                    return ARM_data

                for root, _, files in os.walk(tasks_dir):
                    for file_name in files:
                        file_path = Path(root) / file_name

                        try:
                            #–ü–∞—Ä—Å–∏–º XML —Ñ–∞–π–ª
                            tree = ET.parse(file_path)
                            xml_root = tree.getroot()

                            #–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                            name = file_name
                            is_enabled = True #–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–¥–∞—á–∏ –≤–∫–ª—é—á–µ–Ω—ã, –µ—Å–ª–∏ —Ç–µ–≥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
                            action_path = "–ù–µ—Ç ExecAction"
                            author = "–°–∏—Å—Ç–µ–º–∞/–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"

                            #–ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –¥–µ—Ä–µ–≤—É XML
                            #–¢–∞–∫ –∫–∞–∫ namespace –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è, –∏—â–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ç–µ–≥–æ–≤
                            for elem in xml_root.iter():
                                tag = strip_namespace(elem.tag)

                                if tag == "Author":
                                    author = elem.text if elem.text else author

                                elif tag == "Enabled":
                                    #–ï—Å–ª–∏ —Ç–µ–∫—Å—Ç "false", —Ç–æ –∑–∞–¥–∞—á–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞
                                    if elem.text and elem.text.lower() == "false":
                                        is_enabled = False

                                elif tag == "Command":
                                    #–ò—â–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º—É—é –∫–æ–º–∞–Ω–¥—É
                                    action_path = elem.text if elem.text else action_path

                                elif tag == "Arguments":
                                     pass

                            for child in xml_root.iter():
                                if strip_namespace(child.tag) == "Exec":
                                    cmd_text = ""
                                    arg_text = ""
                                    for sub in child:
                                        sub_tag = strip_namespace(sub.tag)
                                        if sub_tag == "Command" and sub.text:
                                            cmd_text = sub.text
                                        if sub_tag == "Arguments" and sub.text:
                                            arg_text = sub.text

                                    if cmd_text:
                                        action_path = f"{cmd_text} {arg_text}".strip()
                                        break #–ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ

                            ARM_data.append({
                                "–ò–º—è": name,
                                "–í–∫–ª/–í—ã–∫–ª": "–í–∫–ª—é—á–µ–Ω" if is_enabled else "–û—Ç–∫–ª—é—á–µ–Ω",
                                "–ü—É—Ç—å": action_path,
                                "–ê–≤—Ç–æ—Ä": author,
                                "TaskPath": str(file_path), #–ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É XML
                                "Enabled_raw": is_enabled
                            })

                        except ET.ParseError:
                            #–≠—Ç–æ –Ω–µ XML –∏–ª–∏ —Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω
                            continue
                        except Exception as e:
                            logger.error(f"ARM - –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞ –∑–∞–¥–∞—á–∏ {file_name}:\n{e}")
                            ARM_data.append({
                                "–ò–º—è": file_name,
                                "–í–∫–ª/–í—ã–∫–ª": "–û—à–∏–±–∫–∞",
                                "–ü—É—Ç—å": "–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è",
                                "–ê–≤—Ç–æ—Ä": "–û—à–∏–±–∫–∞",
                                "TaskPath": str(file_path),
                                "Enabled_raw": False
                            })
                return ARM_data



        #–ò–∑–º–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–í–∫–ª/–í—ã–∫–ª)
        def get_task_startup(task_path_str, enable, item_id, gui_elements):
            if not run_in_recovery:
                manager = TaskSchedulerManager()
                if manager.set_task_state_com(task_path_str, enable):
                    state = "–≤–∫–ª—é—á–µ–Ω–∞" if enable else "–æ—Ç–∫–ª—é—á–µ–Ω–∞"
                    logger.success(f'ARM - –ó–∞–¥–∞—á–∞ "{task_path_str}" —É—Å–ø–µ—à–Ω–æ {state} —á–µ—Ä–µ–∑ COM.')
                    gui_elements["focus_after_update"] = {"type": "iid", "value": item_id}
                    return True
                return False
            else: 
                task_path = Path(task_path_str)
                if not task_path.exists():
                    messagebox.showerror(random_string(), f"–§–∞–π–ª –∑–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω:\n{task_path}")
                    return False
                try:
                    #–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤—Å–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤
                    ET.register_namespace('', "http://schemas.microsoft.com/windows/2004/02/mit/task")
                    tree = ET.parse(task_path)
                    root = tree.getroot()

                    ns = ""
                    if '}' in root.tag:
                        ns = root.tag.split('}')[0] + '}'

                    settings = root.find(f"{ns}Settings")
                    if settings is None:
                        settings = ET.SubElement(root, f"{ns}Settings")

                    enabled_tag = settings.find(f"{ns}Enabled")
                    if enabled_tag is None:
                        enabled_tag = ET.SubElement(settings, f"{ns}Enabled")

                    enabled_tag.text = "true" if enable else "false"

                    if save_xml_task(tree, task_path):
                        state = "–≤–∫–ª—é—á–µ–Ω–∞" if enable else "–æ—Ç–∫–ª—é—á–µ–Ω–∞"
                        logger.success(f'ARM - –ó–∞–¥–∞—á–∞ "{task_path.name}" —É—Å–ø–µ—à–Ω–æ {state} —á–µ—Ä–µ–∑ XML.')
                        gui_elements["focus_after_update"] = {"type": "iid", "value": item_id}
                        return True
                    return False
                except Exception as e:
                    logger.error(f"ARM - –û—à–∏–±–∫–∞ XML:\n{e}")
                    messagebox.showerror(random_string(), f"–û—à–∏–±–∫–∞ XML:\n{e}")
                    return False



        #–£–¥–∞–ª—è–µ–º –∑–∞–¥–∞—á—É –∏–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
        def delete_task_scheduler_task(task_path_str, task_name, item_id, gui_elements):
            if not run_in_recovery:
                manager = TaskSchedulerManager()
                if manager.delete_task_com(task_path_str):
                    logger.success(f'ARM - –ó–∞–¥–∞—á–∞ "{task_path_str}" —É–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ COM.')
                    gui_elements["focus_after_update"] = get_next_item_iid(gui_elements, item_id)
                    return True
                return False
            else: 
                try:
                    task_path = Path(task_path_str)
                    if task_path.exists():
                        gui_elements["focus_after_update"] = get_next_item_iid(gui_elements, item_id)
                        task_path.unlink()
                        logger.success(f"ARM - XML —Ñ–∞–π–ª –∑–∞–¥–∞—á–∏ —É–¥–∞–ª–µ–Ω: {task_path}")
                        return True
                    else:
                        messagebox.showerror(random_string(), "–§–∞–π–ª –∑–∞–¥–∞—á–∏ —É–∂–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.")
                        return False
                except Exception as e:
                    logger.error(f"ARM - –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è XML —Ñ–∞–π–ª–∞:\n{e}")
                    messagebox.showerror(random_string(), f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª:\n{e}")
                    return False



        #–û –ü—Ä–æ–≥—Ä–∞–º–º–µ
        def about_ARM():
            messagebox.showinfo(random_string(), f"–ú–∞—Å—Ç–µ—Ä –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ - {autorun_master_version}")



        #–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–º–µ–Ω—ã –≤–∫–ª–∞–¥–∫–∏
        def on_tab_change(event, gui_elements, ARM_CORE_GLOBALS):
            selected_tab = gui_elements["notebook"].tab(gui_elements["notebook"].select(), "text")
            if selected_tab != gui_elements["current_tab"]:
                gui_elements["current_tab"] = selected_tab
                set_treeview_columns(gui_elements)
                load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤
        def _to_sortable_type(val):
            try:
                #–ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —á–∏—Å–ª–æ
                return float(val)
            except (ValueError, TypeError):
                #–ò–Ω–∞—á–µ –≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ —Å—Ç—Ä–æ–∫—É –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
                return str(val).lower()



        #–°–æ—Ä—Ç–∏—Ä—É–µ–º —Å—Ç–æ–ª–±–∏–∫ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫
        def sort_treeview_column(gui_elements, col):
            tree = gui_elements.get("tree")
            if not tree:
                return

            items = tree.get_children("") 
            if not items:
                return

            gui_elements.setdefault("sort_direction", {})
            reverse = gui_elements["sort_direction"].get(col, "asc") == "desc"
            gui_elements["sort_direction"][col] = "desc" if not reverse else "asc"

            data_to_sort = []
            for item_id in items:
                val = tree.set(item_id, col)
                sortable_val = _to_sortable_type(val)
                data_to_sort.append((sortable_val, item_id))

            data_to_sort.sort(key=lambda t: t[0], reverse=reverse)

            for i, (val, item_id) in enumerate(data_to_sort):
                tree.move(item_id, "", i)

            all_cols = list(tree["columns"])

            for c in all_cols:
                current_text = tree.heading(c, "text")
                current_text = current_text.replace(" \u25B2", "").replace(" \u25BC", "")
                tree.heading(c, text=current_text)

            arrow = " \u25BC" if reverse else " \u25B2"
            current_text = tree.heading(col, "text")
            tree.heading(col, text=current_text + arrow)



        #–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–æ–∫—É—Å–∞ Treeview
        def handle_treeview_focus_in(gui_elements):
            tree = gui_elements.get("tree")
            if not tree:
                return

            items = tree.get_children("")

            if items:
                if not tree.selection():
                    first_item = items[0]
                    tree.selection_set(first_item)
                    tree.focus(first_item)



        #–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–æ–ª–±–∏–∫–æ–≤, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∫–ª–∞–¥–∫–∏
        def set_treeview_columns(gui_elements):
            if gui_elements["tree"] and gui_elements["tree"].winfo_exists():
                gui_elements["tree"].destroy()

            current_frame = gui_elements["tabs"][gui_elements["current_tab"]]

            if gui_elements["vsb"] and gui_elements["vsb"].winfo_exists():
                gui_elements["vsb"].pack_forget()

            gui_elements["tree"] = ttk.Treeview(current_frame, selectmode="browse")
            gui_elements["tree"].pack(side="left", fill="both", expand=True)

            gui_elements["vsb"] = ttk.Scrollbar(current_frame, orient="vertical", command=gui_elements["tree"].yview)
            gui_elements["vsb"].pack(side="right", fill="y")
            gui_elements["tree"].configure(yscrollcommand=gui_elements["vsb"].set)

            gui_elements["tree"].bind("<Button-3>", lambda e: handle_right_click(e, gui_elements, ARM_CORE_GLOBALS))
            gui_elements["tree"].bind("<Key>", lambda e: handle_key_press(e, gui_elements, ARM_CORE_GLOBALS))
            gui_elements["tree"].bind("<c>", lambda e: handle_menu_key(e, gui_elements, ARM_CORE_GLOBALS))

            gui_elements["tree"].bind("<FocusIn>", lambda e: handle_treeview_focus_in(gui_elements))

            columns = []
            headings = {}

            if gui_elements["current_tab"] == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è":
                columns = ("–ò–º—è –§–∞–π–ª–∞", "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è", "–î–∞—Ç–∞ –ò–∑–º–µ–Ω–µ–Ω–∏—è", "–î–∞—Ç–∞ –û—Ç–∫—Ä—ã—Ç–∏—è")
                headings = dict(zip(columns, columns))
            elif gui_elements["current_tab"] == "–†–µ–µ—Å—Ç—Ä":
                columns = ("–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞")
                headings = dict(zip(columns, columns))
            elif gui_elements["current_tab"] == "–°–∏—Å—Ç–µ–º–Ω–∞—è":
                columns = ("–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞")
                headings = dict(zip(columns, columns))
            elif gui_elements["current_tab"] == "AppInit_DLLs":
                columns = ["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ë–∏—Ç–Ω–æ—Å—Ç—å", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
                headings = dict(zip(columns, columns))
            elif gui_elements["current_tab"] == "CmdLine":
                columns = ("–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞")
                headings = dict(zip(columns, columns))
            elif gui_elements["current_tab"] == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                columns = ("–ò–º—è", "–í–∫–ª/–í—ã–∫–ª", "–ü—É—Ç—å", "–ê–≤—Ç–æ—Ä")
                headings = dict(zip(columns, columns))

            gui_elements["tree"]["columns"] = columns
            gui_elements["tree"]["show"] = "headings"

            for col in columns:
                gui_elements["tree"].heading(
                    col, 
                    text=headings.get(col, col),
                    command=lambda _col=col: sort_treeview_column(gui_elements, _col)
                )
                gui_elements["tree"].column(col, width=100, anchor=tk.W)

            if columns:
                gui_elements["tree"].column(columns[0], width=150, anchor=tk.W)
                if gui_elements["current_tab"] == "AppInit_DLLs":
                        gui_elements["tree"].column(columns[0], width=75, anchor=tk.W)
                        gui_elements["tree"].column(columns[1], width=15, anchor=tk.W)
                        gui_elements["tree"].column(columns[2], width=150, anchor=tk.W)
                        gui_elements["tree"].column(columns[3], width=75, anchor=tk.W)
                if gui_elements["current_tab"] in ["–†–µ–µ—Å—Ç—Ä", "–°–∏—Å—Ç–µ–º–Ω–∞—è", "CmdLine"]:
                        gui_elements["tree"].column(columns[0], width=100, anchor=tk.W)
                        gui_elements["tree"].column(columns[1], width=250, anchor=tk.W)
                        gui_elements["tree"].column(columns[2], width=50, anchor=tk.W)
                        gui_elements["tree"].column(columns[3], width=75, anchor=tk.W)
                if gui_elements["current_tab"] == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                    gui_elements["tree"].column(columns[0], width=175, anchor=tk.W)
                    gui_elements["tree"].column(columns[1], width=65, anchor=tk.W)
                    gui_elements["tree"].column(columns[2], width=300, anchor=tk.W)
                    gui_elements["tree"].column(columns[3], width=50, anchor=tk.W)



        #–í–æ—Å—Å–∞–Ω–∞–≤–ª–∏–≤—ã–≤–∞–µ–º —Ñ–æ–∫—É—Å –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        def restore_focus_after_update(gui_elements):
            tree = gui_elements["tree"]
            focus_info = gui_elements["focus_after_update"]
            gui_elements["focus_after_update"] = None

            if focus_info:
                target_iid = None

                if focus_info["type"] == "iid":
                    if tree.exists(focus_info["value"]):
                        target_iid = focus_info["value"]

                elif focus_info["type"] == "name":
                    name_to_find = focus_info["value"]
                    current_cols = tree["columns"]
                    name_col_index = current_cols.index("–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞") if "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞" in current_cols else -1

                    if name_col_index != -1:
                        for item_id in tree.get_children(""):
                            values = tree.item(item_id, 'values')
                            if values and values[name_col_index] == name_to_find:
                                target_iid = item_id
                                break

                if target_iid:
                    tree.selection_set(target_iid)
                    tree.focus(target_iid)
                    tree.see(target_iid)
                    return

            items = tree.get_children("")
            if items:
                if not tree.selection():
                    tree.selection_set(items[0])
                    tree.focus(items[0])



        #–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
        def load_current_tab_data(gui_elements, ARM_CORE_GLOBALS):
            tree = gui_elements["tree"]
            current_tab = gui_elements["current_tab"]

            for item in tree.get_children():
                tree.delete(item)

            if current_tab == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è":
                gui_elements["treeview_data"] = get_user_startup(ARM_CORE_GLOBALS)
                columns = ["–ò–º—è –§–∞–π–ª–∞", "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è", "–î–∞—Ç–∞ –ò–∑–º–µ–Ω–µ–Ω–∏—è", "–î–∞—Ç–∞ –û—Ç–∫—Ä—ã—Ç–∏—è"]
            elif current_tab == "–†–µ–µ—Å—Ç—Ä":
                gui_elements["treeview_data"] = get_registry_startup(ARM_CORE_GLOBALS)
                columns = ["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            elif current_tab == "–°–∏—Å—Ç–µ–º–Ω–∞—è":
                gui_elements["treeview_data"] = get_system_startup(ARM_CORE_GLOBALS)
                columns = ["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            elif current_tab == "AppInit_DLLs":
                gui_elements["treeview_data"] = get_dll_startup(ARM_CORE_GLOBALS)
                columns = ["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ë–∏—Ç–Ω–æ—Å—Ç—å", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            elif current_tab == "CmdLine":
                if first_run:
                    messagebox.showinfo(random_string(), "–í —ç—Ç–æ–π –≤–∫–ª–∞–¥–∫–µ –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –≤ CmdLine.")
                gui_elements["treeview_data"] = get_cmdline_startup(ARM_CORE_GLOBALS)
                columns = ["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–¢–∏–ø –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            elif current_tab == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                if first_run:
                    messagebox.showinfo(random_string(), '–í–æ –≤–∫–ª–∞–¥–∫–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–∞–∫ –º–Ω–æ–≥–æ –∑–∞–¥–∞—á, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–∏—Ä—É—Å—ã –º–æ–≥–ª–∏ –º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, –Ω–æ —Ç–∞–∫–æ–µ –∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ, –ø–æ—ç—Ç–æ–º—É –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–¥–∞—á –±–µ–∑ –≥—Ä–∞—Ñ–∞ "—Å–æ–∑–¥–∞–Ω". –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–∂–º–∏—Ç–µ –ø—É–Ω–∫—Ç—ã –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –æ–∫–Ω–∞: –≤–∏–¥->–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ —Å –¥–∞—Ç–æ–π.')

                raw_tasks = get_task_scheduler_startup()
                
                if show_only_with_date.get():
                    gui_elements["treeview_data"] = [
                        t for t in raw_tasks 
                        if t.get("–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è") and t.get("–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è") not in ["", "–û—à–∏–±–∫–∞", "01-01-1970 00:00:00"]
                    ]
                else:
                    gui_elements["treeview_data"] = raw_tasks
                    
                columns = ["–ò–º—è", "–í–∫–ª/–í—ã–∫–ª", "–ü—É—Ç—å", "–ê–≤—Ç–æ—Ä"]
            else:
                gui_elements["treeview_data"] = []
                columns = []

            for item_data in gui_elements["treeview_data"]:
                values = [item_data.get(col, "") for col in columns]
                unique_id = item_data.get("TaskPath") or str(hash(frozenset(item_data.items())))
                tree.insert("", "end", values=values, tags=("ARM_data",), iid=unique_id, open=True)

            restore_focus_after_update(gui_elements)



        #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è iid –±–ª–∏–∂–∞–π—à–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        def get_next_item_iid(gui_elements, current_item_id):
            tree = gui_elements["tree"]
            items = list(tree.get_children(""))
            try:
                current_index = items.index(current_item_id)
                if current_index + 1 < len(items):
                    return {"type": "iid", "value": items[current_index + 1]}
                elif current_index - 1 >= 0:
                    return {"type": "iid", "value": items[current_index - 1]}
                else:
                    return None
            except ValueError:
                return None



        #–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ú–µ–Ω—é
        def show_context_menu(event, gui_elements, ARM_CORE_GLOBALS, item_data, item_id):
            master = gui_elements["master"]
            current_tab = gui_elements["current_tab"]
            reg_keys = ARM_CORE_GLOBALS["REG_KEYS"]

            menu = tk.Menu(master, tearoff=0)

            if current_tab != "–°–∏—Å—Ç–µ–º–Ω–∞—è" and current_tab != "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è" and current_tab != "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫" and current_tab != "CmdLine":
                create_menu = tk.Menu(menu, tearoff=0)

                if current_tab in ["–†–µ–µ—Å—Ç—Ä", "AppInit_DLLs"]:
                    if current_tab == "–†–µ–µ—Å—Ç—Ä":
                        hkey_const, subkey_path, _ = reg_keys["–†–µ–µ—Å—Ç—Ä"][0]
                    elif current_tab == "AppInit_DLLs":
                        hkey_const, subkey_path, _, _ = reg_keys["AppInit_DLLs"][0]

                    for reg_type_str in CREATABLE_REG_TYPES:
                        create_menu.add_command(
                            label=f"–ü–∞—Ä–∞–º–µ—Ç—Ä {reg_type_str}",
                            command=lambda type=reg_type_str: prompt_for_new_reg_value(gui_elements, hkey_const, subkey_path, type)
                        )
                    menu.add_cascade(label="–°–æ–∑–¥–∞—Ç—å", menu=create_menu)
                    menu.add_separator()

            if item_data:
                if current_tab == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è":
                    file_path = item_data["–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
                    file_name = item_data["–ò–º—è –§–∞–π–ª–∞"]

                    menu.add_command(label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ü—É—Ç—å (Ctrl+C)", command=lambda: copy_to_clipboard(master, file_path))
                    menu.add_command(label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ (Ctrl+Shift+C)", command=lambda: copy_to_clipboard(master, file_name))
                    menu.add_separator()
                    menu.add_command(label="–£–¥–∞–ª–∏—Ç—å –§–∞–π–ª (Delete)", command=lambda: confirm_and_delete_file(gui_elements, file_path, file_name, item_id))

                elif current_tab in ["–†–µ–µ—Å—Ç—Ä", "–°–∏—Å—Ç–µ–º–Ω–∞—è", "AppInit_DLLs", "CmdLine"]:
                    reg_name = item_data["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
                    reg_path = item_data["–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]

                    menu.add_command(label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç—å (Ctrl+C)", command=lambda: copy_to_clipboard(master, reg_path))
                    menu.add_command(label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (Ctrl+Shift+C)", command=lambda: copy_to_clipboard(master, reg_name))
                    menu.add_separator()

                    if item_data.get("value_type") not in [winreg.REG_NONE, None]:
                        menu.add_command(label="–ò–∑–º–µ–Ω–∏—Ç—å (E)", command=lambda: open_edit_dialog(gui_elements, item_data, item_id))
                    else:
                         menu.add_command(label="–ò–∑–º–µ–Ω–∏—Ç—å (E)", state=tk.DISABLED)

                    if current_tab == "–†–µ–µ—Å—Ç—Ä":
                        menu.add_command(label="–£–¥–∞–ª–∏—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä (Delete)", command=lambda: confirm_and_delete_reg_value(gui_elements, item_data, item_id))

                elif current_tab == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                    task_name = item_data["–ò–º—è"]
                    task_path_full = item_data["TaskPath"]
                    task_action_path = item_data["–ü—É—Ç—å"]
                    is_enabled = item_data["Enabled_raw"]

                    menu.add_command(label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ü—É—Ç—å (Ctrl+C)", command=lambda: copy_to_clipboard(master, task_action_path))
                    menu.add_separator()

                    if is_enabled:
                        menu.add_command(label="–û—Ç–∫–ª—é—á–∏—Ç—å (O)", command=lambda: confirm_and_set_task_state(gui_elements, task_path_full, task_name, False, item_id))
                        menu.add_command(label="–í–∫–ª—é—á–∏—Ç—å (O)", state=tk.DISABLED)
                    else:
                        menu.add_command(label="–û—Ç–∫–ª—é—á–∏—Ç—å (O)", state=tk.DISABLED)
                        menu.add_command(label="–í–∫–ª—é—á–∏—Ç—å (O)", command=lambda: confirm_and_set_task_state(gui_elements, task_path_full, task_name, True, item_id))
                    menu.add_separator()
                    menu.add_command(label="–£–¥–∞–ª–∏—Ç—å (Delete)", command=lambda: confirm_and_delete_task(gui_elements, task_path_full, task_name, item_id))

            try:
                menu.tk_popup(event.x_root, event.y_root)
            finally:
                menu.grab_release()



        #–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ü–ö–ú
        def handle_right_click(event, gui_elements, ARM_CORE_GLOBALS):
            item_id = gui_elements["tree"].identify_row(event.y)
            gui_elements["tree"].selection_set(item_id)
            if item_id:
                selected_values = gui_elements["tree"].item(item_id, 'values')
                current_cols = gui_elements["tree"]["columns"]
                item_data = next((data for data in gui_elements["treeview_data"] if [str(data.get(k, "")) for k in current_cols] == list(selected_values)), None)
            else:
                item_data = None
            show_context_menu(event, gui_elements, ARM_CORE_GLOBALS, item_data, item_id)



        #–ö–æ–ø–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        def copy_to_clipboard(master, text):
            master.clipboard_clear()
            master.clipboard_append(text)



        #–î–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        def open_edit_dialog(gui_elements, item_data, item_id):
            master = gui_elements["master"]
            name = item_data["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            current_value = str(item_data.get("–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", ""))
            reg_type = item_data["value_type"]
            hkey_const = item_data["hkey"]
            subkey_path = item_data["subkey"]

            if reg_type == winreg.REG_MULTI_SZ:
                current_value = "\n".join(item_data.get("–ó–Ω–∞—á–µ–Ω–∏–µ –ü–∞—Ä–∞–º–µ—Ç—Ä–∞", []))

            new_value = simpledialog.askstring(
                random_string(),
                f"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:\n{name} ({REG_TYPE_MAP.get(reg_type, '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π')})",
                initialvalue=current_value,
                parent=master
            )

            if new_value is not None:
                if update_reg_value(hkey_const, subkey_path, name, new_value, reg_type, item_id, gui_elements):
                    load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
        def confirm_and_delete_file(gui_elements, file_path, file_name, item_id):
            if delete_file(file_path, file_name, item_id, gui_elements):
                load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞
        def confirm_and_delete_reg_value(gui_elements, item_data, item_id):
            name = item_data["–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            path = item_data["–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"]
            hkey_const = item_data["hkey"]
            subkey_path = item_data["subkey"]

            if messagebox.askyesno(random_string(), f"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞:\n'{name}' –∏–∑ {path}?"):
                if delete_reg_value(hkey_const, subkey_path, name, item_id, gui_elements):
                    load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–î–∏–∞–ª–æ–≥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞
        def prompt_for_new_reg_value(gui_elements, hkey_const, subkey_path, reg_type_str):
            master = gui_elements["master"]
            name = simpledialog.askstring(
                random_string(),
                f"–í–≤–µ–¥–∏—Ç–µ –∏–º—è –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞ ({reg_type_str}) –¥–ª—è\n{ARM_CORE_GLOBALS["HKEY_MAP"].get(hkey_const)}\\{subkey_path}:",
                parent=master
            )
            if name:
                if create_reg_value(hkey_const, subkey_path, name, reg_type_str, gui_elements):
                    load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (–í—ã–∫–ª –∏–ª–∏ –í–∫–ª)
        def confirm_and_set_task_state(gui_elements, task_path_full, task_name, enable, item_id):
            if get_task_startup(task_path_full, enable, item_id, gui_elements):
                load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
        def confirm_and_delete_task(gui_elements, task_path_full, task_name, item_id):
            if delete_task_scheduler_task(task_path_full, task_name, item_id, gui_elements):
                load_current_tab_data(gui_elements, ARM_CORE_GLOBALS)



        #–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        def get_selected_item_data(gui_elements):
            tree = gui_elements["tree"]
            item_id = tree.focus()
            if not item_id:
                return None, None

            selected_values = tree.item(item_id, 'values')
            current_cols = tree["columns"]

            item_data = next((data for data in gui_elements["treeview_data"] if [str(data.get(k, "")) for k in current_cols] == list(selected_values)), None)
            return item_id, item_data



        #–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à
        def handle_key_press(event, gui_elements, ARM_CORE_GLOBALS):
            item_id, item_data = get_selected_item_data(gui_elements)

            keysym = event.keysym
            current_tab = gui_elements["current_tab"]
            tree = gui_elements["tree"]

            ctrl_mask = 0x0004
            shift_mask = 0x0001
            is_ctrl = (event.state & ctrl_mask) != 0
            is_shift = (event.state & shift_mask) != 0

            sort_key_map = {
                "1": 0,
                "2": 1,
                "3": 2,
                "4": 3
            }

            if keysym in sort_key_map.keys() and not is_ctrl and not is_shift:
                column_index = sort_key_map[keysym]
                current_columns = tree["columns"]

                if column_index < len(current_columns):
                    column_id = current_columns[column_index]
                    sort_treeview_column(gui_elements, column_id)
                    return "break"

            if not item_data: return

            if keysym == "e" and not is_ctrl and current_tab not in ["–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è", "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫"]:
                if item_data.get("value_type") not in [winreg.REG_NONE, None]:
                    open_edit_dialog(gui_elements, item_data, item_id)
                return "break"

            elif keysym == "o" and not is_ctrl and current_tab == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                task_name = item_data["–ò–º—è"]
                task_path_full = item_data["TaskPath"]
                is_enabled = item_data["Enabled_raw"]
                confirm_and_set_task_state(gui_elements, task_path_full, task_name, not is_enabled, item_id)
                return "break"

            elif keysym == "Delete" and current_tab not in ["–°–∏—Å—Ç–µ–º–Ω–∞—è", "AppInit_DLLs", "CmdLine"]:
                if current_tab == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è":
                    confirm_and_delete_file(gui_elements, item_data["–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"], item_data["–ò–º—è –§–∞–π–ª–∞"], item_id)
                elif current_tab == "–†–µ–µ—Å—Ç—Ä":
                    confirm_and_delete_reg_value(gui_elements, item_data, item_id)
                elif current_tab == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                    confirm_and_delete_task(gui_elements, item_data["TaskPath"], item_data["–ò–º—è"], item_id)
                return "break"

            elif keysym == "c" and is_ctrl:
                if is_shift:
                    if current_tab != "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫":
                        name_key = "–ò–º—è –§–∞–π–ª–∞" if current_tab == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è" else "–ò–º—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"
                        copy_to_clipboard(gui_elements["master"], item_data.get(name_key, ""))
                else:
                    path_key = "–ü—É—Ç—å" if current_tab == "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫" else "–ü—É—Ç—å –ü–∞—Ä–∞–º–µ—Ç—Ä–∞"
                    copy_to_clipboard(gui_elements["master"], item_data.get(path_key, ""))
                return "break"



        #–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à–∏ Menu
        def handle_menu_key(event, gui_elements, ARM_CORE_GLOBALS):
            item_id, item_data = get_selected_item_data(gui_elements)

            tree = gui_elements["tree"]
            x, y = 0, 0

            if item_id:
                bbox = tree.bbox(item_id)
                if bbox:
                    x = tree.winfo_rootx() + bbox[0]
                    y = tree.winfo_rooty() + bbox[1] + bbox[3]
                else:
                    x = tree.winfo_rootx() + 10
                    y = tree.winfo_rooty() + 10
            else:
                x = tree.winfo_rootx() + 10
                y = tree.winfo_rooty() + 10

            class MockEvent:
                def __init__(self, x_root, y_root):
                    self.x_root = x_root
                    self.y_root = y_root

            mock_event = MockEvent(x, y)
            show_context_menu(mock_event, gui_elements, ARM_CORE_GLOBALS, item_data, item_id)
            return "break"



        #–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞
        def on_closing():
            GUI_ELEMENTS["master"].destroy()



        ARM = tk.Tk()
        GUI_ELEMENTS["master"] = ARM
        ARM.title(random_string())
        ARM.geometry("650x350")
        style = ttk.Style(ARM)
        style.theme_use("clam")

        show_only_with_date = tk.BooleanVar(value=False)

        ARM.protocol("WM_DELETE_WINDOW", on_closing) 

        GUI_ELEMENTS["current_tab"] = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è"
        GUI_ELEMENTS["treeview_data"] = []
        GUI_ELEMENTS["focus_after_update"] = None

        menubar = tk.Menu(ARM)
        view_menu = tk.Menu(menubar, tearoff=0)
        view_menu.add_checkbutton(
            label="–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ —Å –¥–∞—Ç–æ–π", 
            variable=show_only_with_date,
            command=lambda: load_current_tab_data(GUI_ELEMENTS, ARM_CORE_GLOBALS)
        )
        menubar.add_cascade(label="–í–∏–¥", menu=view_menu)
        
        menubar.add_cascade(label="–û –ø—Ä–æ–≥—Ä–∞–º–º–µ", command=about_ARM)
        ARM.config(menu=menubar)

        GUI_ELEMENTS["notebook"] = ttk.Notebook(ARM)
        GUI_ELEMENTS["notebook"].pack(pady=10, padx=10, fill="both", expand=True)
        GUI_ELEMENTS["notebook"].bind("<<NotebookTabChanged>>", lambda e: on_tab_change(e, GUI_ELEMENTS, ARM_CORE_GLOBALS))

        tab_names = ["–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è", "–†–µ–µ—Å—Ç—Ä", "–°–∏—Å—Ç–µ–º–Ω–∞—è", "AppInit_DLLs", "CmdLine", "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫"]
        for tab_name in tab_names:
            frame = ttk.Frame(GUI_ELEMENTS["notebook"], padding="5 5 5 5")
            GUI_ELEMENTS["notebook"].add(frame, text=tab_name)
            GUI_ELEMENTS["tabs"][tab_name] = frame

        initial_frame = GUI_ELEMENTS["tabs"]["–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è"]
        GUI_ELEMENTS["tree"] = ttk.Treeview(initial_frame, selectmode="browse")
        GUI_ELEMENTS["vsb"] = ttk.Scrollbar(initial_frame, orient="vertical", command=GUI_ELEMENTS["tree"].yview)
        GUI_ELEMENTS["tree"].configure(yscrollcommand=GUI_ELEMENTS["vsb"].set)
        GUI_ELEMENTS["tree"].pack(side="left", fill="both", expand=True)
        GUI_ELEMENTS["vsb"].pack(side="right", fill="y")

        GUI_ELEMENTS["tree"].bind("<Button-3>", lambda e: handle_right_click(e, GUI_ELEMENTS, ARM_CORE_GLOBALS))

        set_treeview_columns(GUI_ELEMENTS)
        load_current_tab_data(GUI_ELEMENTS, ARM_CORE_GLOBALS)

        ARM.mainloop()

    except Exception as e:
        comment = f"–í –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–µ ARM –ø—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞!\n{e}"
        logger.error(comment)
        messagebox.showerror(random_string(), comment)
